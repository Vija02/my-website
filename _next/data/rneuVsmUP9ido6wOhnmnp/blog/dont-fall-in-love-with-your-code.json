{"pageProps":{"title":"Don't fall in love without your code","description":"Sometimes the best code is the code you delete. Don't love your code and do what's best for the codebase.","image":"/assets/blog/dont-fall-in-love-with-your-code/dont-fall-in-love-with-your-code.png","createdAt":"Sat Dec 07 2024 00:00:00 GMT+0000 (Greenwich Mean Time)","source":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    code: \"code\",\n    em: \"em\",\n    h2: \"h2\",\n    h3: \"h3\",\n    hr: \"hr\",\n    img: \"img\",\n    li: \"li\",\n    ol: \"ol\",\n    p: \"p\",\n    pre: \"pre\",\n    span: \"span\",\n    strong: \"strong\",\n    ..._provideComponents(),\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"I just deleted hundreds of lines of code I wrote yesterday and replaced them with 32 lines of new code. This was for a feature for \", _jsx(_components.a, {\n        href: \"https://github.com/Vija02/TheOpenPresenter\",\n        children: \"TheOpenPresenter\"\n      }), \", used to indicate if an audio is playing.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Every so often, I’d work on a functionality that seems quite straightforward to implement. In this case, I just needed to show this icon when audio is playing.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/blog/dont-fall-in-love-with-your-code/sample.png\",\n        alt: \"sample\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Simple enough. Each of these is a scene containing multiple plugins. Each plugin has its own property like \", _jsx(_components.code, {\n        children: \"isPlaying\"\n      }), \" . We can merge the values between the plugins, and if the flag is true, we can show the icon.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Architecting a solution\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The main issue is how to access this data. See, we could access the data directly. But each plugin can have its own schema. While some plugins may have a simple \", _jsx(_components.strong, {\n        children: \"isPlaying\"\n      }), \" property, some others might need something more complicated to represent its playing status.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Simple, why not allow the plugin to register a callback/function that returns the state?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This is the same pattern that TheOpenPresenter uses for many of its plugins. And while we’re at it, we can abstract it into a \", _jsx(_components.strong, {\n        children: \"SceneState\"\n      }), \" object. So if we ever need any other state, we can add it here. Here’s how it might look like for the plugin:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki one-dark-pro\",\n      style: {\n        backgroundColor: \"#282c34\",\n        color: \"#abb2bf\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        children: [_jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#7F848E\",\n              fontStyle: \"italic\"\n            },\n            children: \"// The pattern we use for plugins\"\n          })\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"serverPluginApi\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"onPluginDataCreated\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"pluginName\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \", \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"onPluginDataCreated\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \");\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"serverPluginApi\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"onPluginDataLoaded\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"pluginName\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \", \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"onPluginDataLoaded\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \");\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"serverPluginApi\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"registerRemoteViewWebComponent\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"  pluginName\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \",\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"  remoteWebComponentTag\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \",\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \");\"\n          })\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#7F848E\",\n              fontStyle: \"italic\"\n            },\n            children: \"// Example of how the new API might look like\"\n          })\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"serverPluginApi\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"registerSceneState\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"  pluginName\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \",\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"  (\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\",\n              fontStyle: \"italic\"\n            },\n            children: \"_\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \", \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\",\n              fontStyle: \"italic\"\n            },\n            children: \"rendererData\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \") \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"=>\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \" {\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"    return\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \" {\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"      audioIsPlaying\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \": \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#56B6C2\"\n            },\n            children: \"!!\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"rendererData\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"find\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"((\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\",\n              fontStyle: \"italic\"\n            },\n            children: \"x\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \") \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"=>\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \" x\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"isPlaying\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"),\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"    }\"\n          })\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"  },\"\n          })\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \");\"\n          })\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Server handling\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Notice that the code above is handled on the server. This is because TheOpenPresenter consists of 3 separate components:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"The Remote - where this audio indication is shown\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"The Renderer - plays the audio\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"The Server - connects the two\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Ideally, we should handle this in the frontend (remote) so that we don’t add extra load to the server. However, registering this function can be messy. Our frontend uses a micro-frontend architecture loaded with Web components.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The red area below is a React shell. The green area is loaded through web components and is managed by each plugin.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/assets/blog/dont-fall-in-love-with-your-code/shell.png\",\n        alt: \"Shell\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Notice that the audio icon is located on the left side of the shell. How do we provide the function that we need to the shell? We could include a JS function in the web component bundle but that sounds like a mess in the long term.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Handling this on the server seems like the proper way to do this.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Plumbing the data through\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"With that decided, it’s time for implementation. There are a few things to do:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Create the plugin API\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Provide this data to the frontend\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Consume and update the UI\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Implementing\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I won’t bore you with the details so here’s an overview. The API was not quite straightforward since our data can be quite confusing. In short: A scene can have multiple plugins. And there can be multiple renderers, each viewing a scene in a different way. So a plugin could have multiple renderers showing it in different ways. But with a bit of data manipulation, problem solved.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Consuming and updating the UI\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Consuming the value was straightforward. I contemplated using Yjs’s awareness protocol to provide the data since it’s real-time and the framework is already in place. This is how the state is stored. However, including this data from the server is its own problem. So I decided to use GraphQL instead - the protocol we’re using for everything else in the platform.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"So all we need to do is call the endpoint, listen to it using GraphQL’s subscription, and show the icon as needed. Done.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Providing this data to the frontend\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Thankfully, we use \", _jsx(_components.a, {\n        href: \"https://postgraphile.org/\",\n        children: \"Postgraphile\"\n      }), \" which makes extending the GraphQL schema quite straightforward. We can also make it a subscription simply by adding  \", _jsx(_components.code, {\n        children: \"@pgSubscription\"\n      }), \" to the GraphQL schema. It’ll then watch a topic and update the value whenever we call \", _jsx(_components.code, {\n        children: \"pg_notify\"\n      }), \" on that topic. For example:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki one-dark-pro\",\n      style: {\n        backgroundColor: \"#282c34\",\n        color: \"#abb2bf\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"await\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \" pgPool\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"query\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#98C379\"\n            },\n            children: \"  `select pg_notify('graphql:sceneState:\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"${\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"id\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"}\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#98C379\"\n            },\n            children: \"','{}');`\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \",\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"  [],\"\n          })\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \");\"\n          })\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Manipulating the data was annoying but just a bit of patience and it’s done!\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The last piece of the puzzle is calling \", _jsx(_components.code, {\n        children: \"pg_notify\"\n      }), \" when we need to.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For this, we can add a listener to the state (Yjs) and call the notify whenever anything changes:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki one-dark-pro\",\n      style: {\n        backgroundColor: \"#282c34\",\n        color: \"#abb2bf\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"state\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"observeDeep\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"async\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \" () \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"=>\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \" {\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#7F848E\",\n              fontStyle: \"italic\"\n            },\n            children: \"  // Call pg_notify here\"\n          })\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"});\"\n          })\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The only thing left to do is performance improvements. Right now, the function is called for every small change, it’s also updated to the frontend. We can calculate the resulting state and compare if anything changes before pushing the update.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Better solution\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now this solution certainly works. But I hated that we were listening to every single change. It’s unnecessary and I’m not sure how the performance will scale. Is there any better solution?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"So I stepped back for a second and an idea came: \", _jsx(_components.strong, {\n        children: \"How about we go to the basics and use the data from Yjs?\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The problem was that each plugin may use different ways to indicate play status. So we needed a way to know how to calculate the resulting state ourselves. But rather than letting the user pass a function, \", _jsx(_components.strong, {\n        children: \"why not reserve a property that they can use to indicate this?\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Rather than passing a function to calculate the state, each plugin could set the reserved state directly alongside their existing data with properties like \", _jsx(_components.code, {\n        children: \"__audioIsPlaying\"\n      }), \" . They could use this value directly, or they could keep it in sync with their existing properties like so:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki one-dark-pro\",\n      style: {\n        backgroundColor: \"#282c34\",\n        color: \"#abb2bf\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"const\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \" onRendererDataLoaded\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#56B6C2\"\n            },\n            children: \" =\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \" (\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E06C75\",\n              fontStyle: \"italic\"\n            },\n            children: \"  rendererData\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \",\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \") \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"=>\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \" {\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"  watchYjs\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#7F848E\",\n              fontStyle: \"italic\"\n            },\n            children: \"\\t  // Watch the isPlaying property\"\n          })\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"    (\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\",\n              fontStyle: \"italic\"\n            },\n            children: \"x\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \") \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"=>\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \" x\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E06C75\"\n            },\n            children: \"isPlaying\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \",\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"    () \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#C678DD\"\n            },\n            children: \"=>\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \" {\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#7F848E\",\n              fontStyle: \"italic\"\n            },\n            children: \"\\t    // And if it changes, sync the __audioIsPlaying property\"\n          })\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"      rendererData\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"set\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#98C379\"\n            },\n            children: \"\\\"__audioIsPlaying\\\"\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \", \"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#E5C07B\"\n            },\n            children: \"rendererData\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \".\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#61AFEF\"\n            },\n            children: \"get\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"(\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#98C379\"\n            },\n            children: \"\\\"isPlaying\\\"\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"));\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"    },\"\n          })\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"  );\"\n          })\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\",\n          children: _jsx(_components.span, {\n            style: {\n              color: \"#ABB2BF\"\n            },\n            children: \"};\"\n          })\n        })]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Deleting old code\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The new method is brilliant. No extra listener, no extra API, just a simple reserved property.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The cost? Well, I already wrote 95% of the first implementation 🫣\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsxs(_components.em, {\n        children: [_jsx(_components.strong, {\n          children: \"“It’ll be such a shame to delete this when I’ve worked on it for so long. Everything else is perfect other than this one thing!”\"\n        }), \" - My mind\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This is not my first time. Not second or third either. This time it was just a few hours of work. The longer it takes to implement, the harder it is to let go. But if we should not get attached to servers, we shouldn’t be attached to the code we write either.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"It’s obvious that the second implementation is better. It’s faster, less moving parts, less API surface, and less code to maintain. The \", _jsx(_components.a, {\n        href: \"https://github.com/Vija02/TheOpenPresenter/commit/485fd2ff4d4dc1fdb1e010da2fe71d9bdc7ca45f\",\n        children: \"first implementation\"\n      }), \" added 289 new lines while the \", _jsx(_components.a, {\n        href: \"https://github.com/Vija02/TheOpenPresenter/commit/8c72633158debf9dcb54e826e61cb69b31a304e7\",\n        children: \"second implementation\"\n      }), \" only added 32 new lines.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"What’s the lesson to learn then?\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Well, maybe find the simplest solution first. But sometimes we don’t reach the best solution just by thinking about it. If that’s the case, \", _jsx(_components.strong, {\n        children: \"don’t love your code and don’t be afraid to throw it away\"\n      }), \". And maybe write a blog post so that you get something out of it!\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you're read this far, you might want to try \", _jsx(_components.a, {\n        href: \"https://theopenpresenter.com/\",\n        children: \"TheOpenPresenter\"\n      }), \"! It's an open-source presentation system that lets you control any of your screens remotely.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Show slideshows, play videos, use as dashboards and many more. The software is still very early in development as you can tell from this post but it's stable enough to use regularly. I personally use it for my meetups every week.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Any questions, do ask. Or feel free to report issues in the \", _jsx(_components.a, {\n        href: \"https://github.com/Vija02/TheOpenPresenter\",\n        children: \"Github repo\"\n      }), \".\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true}